{"version":3,"file":"locker.directive.js","sourceRoot":"","sources":["../../../tmp/ontimize/directives/locker.directive.ts"],"names":[],"mappings":"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","sourcesContent":["import { Directive, ElementRef, Host, Input, Optional, Renderer2 } from '@angular/core';\nimport { Subscription } from 'rxjs';\n\nimport { OFormServiceComponent } from '../components';\n\nexport const DEFAULT_INPUTS_O_LOCKER = [\n  'oLockerMode',\n  /*Default:250ms*/\n  'oLockerDelay'\n];\n\n@Directive({\n  selector: '[oLocker]',\n  inputs: DEFAULT_INPUTS_O_LOCKER\n})\n\nexport class OLockerDirective {\n\n  public static DEFAULT_INPUTS_O_LOCKER = DEFAULT_INPUTS_O_LOCKER;\n\n  private loadingParentDiv;\n  private componentDiv;\n\n  private _oLockerMode = 'disable';\n  private subscription: Subscription;\n\n  constructor(\n    private element: ElementRef,\n    private renderer: Renderer2,\n    @Optional() @Host() private parent: OFormServiceComponent\n  ) {\n    if (parent) {\n      this.subscription = parent.loadingSubject.subscribe(x => this.manageLockerMode(x));\n    }\n  }\n\n  public ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n  }\n\n  private manageLockerMode(loading: boolean): void {\n    if (this._oLockerMode === 'load') {\n      this.manageLoadMode(loading);\n    } else {\n      this.manageDisableMode(loading);\n    }\n  }\n\n  private manageDisableMode(loading: boolean): void {\n    if (loading) {\n      this.parent.enabled = false;\n    } else {\n      this.parent.enabled = true;\n    }\n  }\n\n  private manageLoadMode(loading: boolean): void {\n    if (loading) {\n      this.addLoading();\n    } else {\n      this.removeLoading();\n    }\n  }\n\n  private addLoading(): void {\n    this.componentDiv = this.element.nativeElement.children[0]; // set opacity in componentDiv\n    this.loadingParentDiv = this.renderer.createElement('div');\n    const loaderChild1 = this.renderer.createElement('div');\n    const loaderChild2 = this.renderer.createElement('div');\n    const loaderChild3 = this.renderer.createElement('div');\n    const loaderChild4 = this.renderer.createElement('div');\n    this.renderer.appendChild(this.loadingParentDiv, loaderChild4);\n    this.renderer.appendChild(this.loadingParentDiv, loaderChild3);\n    this.renderer.appendChild(this.loadingParentDiv, loaderChild2);\n    this.renderer.appendChild(this.loadingParentDiv, loaderChild1);\n    this.renderer.insertBefore(this.element.nativeElement, this.loadingParentDiv, this.componentDiv);\n    this.renderer.addClass(this.loadingParentDiv, 'o-loading');\n    this.renderer.addClass(this.element.nativeElement, 'relative');\n    this.renderer.setStyle(this.componentDiv, 'opacity', '0.6');\n  }\n\n  private removeLoading(): void {\n    if (this.loadingParentDiv) {\n      this.renderer.removeChild(this.element.nativeElement, this.loadingParentDiv);\n      this.renderer.removeClass(this.element.nativeElement, 'relative');\n      this.renderer.removeStyle(this.componentDiv, 'opacity');\n    }\n  }\n\n  @Input()\n  set oLockerMode(value: 'load' | 'disabled') {\n    this._oLockerMode = value;\n  }\n\n  @Input()\n  set oLockerDelay(value: number) {\n    this.parent.delayLoad = value;\n  }\n\n}\n"]}