{"version":3,"file":"permissions.service.js","sourceRoot":"","sources":["../../../../tmp/ontimize/services/permissions/permissions.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injector, Injectable } from '@angular/core';\nimport { Observable } from 'rxjs';\nimport { share } from 'rxjs/operators';\nimport { ActivatedRoute, ActivatedRouteSnapshot } from '@angular/router';\nimport { AppConfig } from '../../config/app-config';\nimport { Util } from '../../utils';\nimport { OntimizePermissionsService } from './ontimize-permissions.service';\nimport { OntimizeEEPermissionsService } from './ontimize-ee-permissions.service';\n\nexport type OPermissions = {\n  attr: string;\n  visible: boolean;\n  enabled: boolean;\n};\n\nexport type OFormPermissions = {\n  attr: string;\n  selector: string;\n  components?: OPermissions[];\n  actions?: OPermissions[];\n};\n\nexport type OTableMenuPermissions = {\n  visible: boolean;\n  enabled: boolean;\n  items?: OPermissions[];\n};\n\nexport type OTablePermissions = {\n  attr: string;\n  selector: string;\n  menu?: OTableMenuPermissions;\n  columns?: OPermissions[];\n  actions?: OPermissions[];\n  contextMenu?: OPermissions[];\n};\n\nexport type OComponentPermissions = OFormPermissions | OTablePermissions;\n\nexport type ORoutePermissions = {\n  permissionId: string;\n  enabled?: boolean;\n  components?: OComponentPermissions[];\n};\n\nexport type OPermissionsDefinition = {\n  routes?: ORoutePermissions[];\n  components?: OComponentPermissions[];\n  menu?: OPermissions[];\n};\n\n@Injectable()\nexport class PermissionsService {\n\n  protected permissionsService: any;\n  protected ontimizePermissionsConfig: any;\n\n  protected permissions: OPermissionsDefinition;\n\n  constructor(protected injector: Injector) {\n    const appConfig = this.injector.get(AppConfig).getConfiguration();\n\n    if (Util.isDefined(appConfig.permissionsConfiguration)) {\n      this.ontimizePermissionsConfig = appConfig.permissionsConfiguration;\n    }\n  }\n\n  protected configureService() {\n    let loadingService: any = OntimizePermissionsService;\n    try {\n      this.permissionsService = this.injector.get(loadingService);\n      if (Util.isPermissionsService(this.permissionsService)) {\n        if (this.permissionsService instanceof OntimizePermissionsService) {\n          (this.permissionsService as OntimizePermissionsService).configureService(this.ontimizePermissionsConfig);\n        } else if (this.permissionsService instanceof OntimizeEEPermissionsService) {\n          (this.permissionsService as OntimizeEEPermissionsService).configureService(this.ontimizePermissionsConfig);\n        }\n      }\n    } catch (e) {\n      console.error(e);\n    }\n  }\n\n  restart() {\n    this.permissions = undefined;\n  }\n\n  hasPermissions(): boolean {\n    return this.permissions !== undefined;\n  }\n\n  getUserPermissionsAsPromise(): Promise<boolean> {\n    const self = this;\n    return new Promise((resolve: any, reject: any) => {\n      self.permissions = {};\n      if (Util.isDefined(self.ontimizePermissionsConfig)) {\n        self.configureService();\n        self.queryPermissions().subscribe(() => {\n          resolve(true);\n        }, error => {\n          resolve(true);\n        });\n      } else {\n        resolve(true);\n      }\n    });\n  }\n\n  protected queryPermissions(): Observable<any> {\n    const self = this;\n    const dataObservable: Observable<any> = new Observable(innerObserver => {\n      self.permissionsService.loadPermissions().subscribe((res: any) => {\n        self.permissions = res;\n        innerObserver.next(res);\n      }, (err: any) => {\n        console.error('[Permissions.queryPermissions]: error', err);\n        innerObserver.error(err);\n      }, () => {\n        innerObserver.complete();\n      });\n    });\n    return dataObservable.pipe(share());\n  }\n\n  protected getPermissionIdFromActRoute(actRoute: ActivatedRoute): string {\n    let result: string;\n    let snapshot: ActivatedRouteSnapshot = actRoute.snapshot;\n    result = ((snapshot.data || {})['oPermission'] || {})['permissionId'];\n    while (Util.isDefined(snapshot.firstChild) && !Util.isDefined(result)) {\n      snapshot = snapshot.firstChild;\n      result = ((snapshot.data || {})['oPermission'] || {})['permissionId'];\n    }\n    return result;\n  }\n\n  protected getComponentPermissionsUsingRoute(attr: string, actRoute: ActivatedRoute): OComponentPermissions {\n    let result: OComponentPermissions;\n    const permissionId = this.getPermissionIdFromActRoute(actRoute);\n    if (Util.isDefined(permissionId)) {\n      const routePermissions: ORoutePermissions = (this.permissions.routes || []).find(route => route.permissionId === permissionId);\n      if (Util.isDefined(routePermissions)) {\n        result = (routePermissions.components || []).find(comp => comp.attr === attr);\n      }\n    }\n    return result;\n  }\n\n  protected getOComponentPermissions(attr: string, actRoute: ActivatedRoute, selector: string): any {\n    if (!Util.isDefined(this.permissions)) {\n      return undefined;\n    }\n    let routePermissions: any;\n    let genericRoutePerm: OComponentPermissions = this.getComponentPermissionsUsingRoute(attr, actRoute);\n    if (genericRoutePerm && genericRoutePerm.selector === selector) {\n      routePermissions = genericRoutePerm;\n    }\n    let compPermissions: any;\n    let attrPermissions = (this.permissions.components || []).find(comp => comp.attr === attr);\n    if (attrPermissions && attrPermissions.selector === selector) {\n      compPermissions = attrPermissions;\n    }\n    return {\n      route: routePermissions,\n      component: compPermissions\n    };\n  }\n\n  getTablePermissions(attr: string, actRoute: ActivatedRoute): OTablePermissions {\n    if (!Util.isDefined(this.permissions)) {\n      return undefined;\n    }\n    const perm = this.getOComponentPermissions(attr, actRoute, 'o-table');\n    const routePerm: OTablePermissions = <OTablePermissions>perm.route;\n    const compPerm: OTablePermissions = <OTablePermissions>perm.component;\n    if (!Util.isDefined(routePerm) || !Util.isDefined(compPerm)) {\n      return compPerm || routePerm;\n    }\n    let permissions: OTablePermissions = {\n      selector: 'o-table',\n      attr: routePerm.attr,\n      menu: this.mergeOTableMenuPermissions(compPerm.menu, routePerm.menu),\n      columns: this.mergeOPermissionsArrays(compPerm.columns, routePerm.columns),\n      actions: this.mergeOPermissionsArrays(compPerm.actions, routePerm.actions),\n      contextMenu: this.mergeOPermissionsArrays(compPerm.contextMenu, routePerm.contextMenu)\n    };\n    return permissions;\n  }\n\n  getFormPermissions(attr: string, actRoute: ActivatedRoute): OFormPermissions {\n    if (!Util.isDefined(this.permissions)) {\n      return undefined;\n    }\n    const perm = this.getOComponentPermissions(attr, actRoute, 'o-form');\n    const routePerm: OFormPermissions = <OFormPermissions>perm.route;\n    const compPerm: OFormPermissions = <OFormPermissions>perm.component;\n    if (!Util.isDefined(routePerm) || !Util.isDefined(compPerm)) {\n      return compPerm || routePerm;\n    }\n    let permissions: OFormPermissions = {\n      selector: 'o-form',\n      attr: routePerm.attr,\n      components: this.mergeOPermissionsArrays(compPerm.components, routePerm.components),\n      actions: this.mergeOPermissionsArrays(compPerm.actions, routePerm.actions)\n    };\n    return permissions;\n  }\n\n  getMenuPermissions(attr: string): OPermissions {\n    let permissions;\n    if (!Util.isDefined(this.permissions)) {\n      return undefined;\n    }\n    const allMenu: OPermissions[] = this.permissions.menu || [];\n\n    permissions = allMenu.find(comp => comp.attr === attr);\n\n    return permissions;\n  }\n\n  protected mergeOPermissionsArrays(permissionsA: OPermissions[], permissionsB: OPermissions[]): OPermissions[] {\n    if (!Util.isDefined(permissionsA) || !Util.isDefined(permissionsB)) {\n      return permissionsA || permissionsB;\n    }\n    let result = Object.assign([], permissionsA);\n    permissionsB.forEach((perm: OPermissions) => {\n      let found = result.find(r => r.attr === perm.attr);\n      if (found) {\n        found.visible = perm.visible;\n        found.enabled = perm.enabled;\n      } else {\n        result.push(perm);\n      }\n    });\n    return result;\n  }\n\n  protected mergeOTableMenuPermissions(permissionsA: OTableMenuPermissions, permissionsB: OTableMenuPermissions): OTableMenuPermissions {\n    if (!Util.isDefined(permissionsA) || !Util.isDefined(permissionsB)) {\n      return permissionsA || permissionsB;\n    }\n    let result = {\n      visible: permissionsB.visible,\n      enabled: permissionsB.enabled,\n      items: this.mergeOPermissionsArrays(permissionsA.items, permissionsB.items)\n    };\n    return result;\n  }\n\n  isPermissionIdRouteRestricted(permissionId: string): boolean {\n    const routeData = (this.permissions.routes || []).find(route => route.permissionId === permissionId);\n    return Util.isDefined(routeData) && routeData.enabled === false;\n  }\n}\n"]}