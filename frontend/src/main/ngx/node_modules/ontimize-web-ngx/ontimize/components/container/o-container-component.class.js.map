{"version":3,"file":"o-container-component.class.js","sourceRoot":"","sources":["../../../../tmp/ontimize/components/container/o-container-component.class.ts"],"names":[],"mappings":"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","sourcesContent":["import { AfterViewInit, ElementRef, forwardRef, Inject, Injector, OnDestroy, Optional, ViewChild } from '@angular/core';\nimport { MAT_FORM_FIELD_DEFAULT_OPTIONS } from '@angular/material';\n\nimport { OFormComponent } from '../form/form-components';\nimport { Util } from '../../utils';\n\nexport const DEFAULT_INPUTS_O_CONTAINER = [\n  'oattr: attr',\n  'title',\n  'layoutAlign: layout-align',\n  'elevation',\n  'icon',\n  'appearance',\n  'layoutGap: layout-gap'\n];\n\nexport class OContainerComponent implements AfterViewInit, OnDestroy {\n\n  public static APPEARANCE_OUTLINE = 'outline';\n  public static DEFAULT_INPUTS_O_CONTAINER = DEFAULT_INPUTS_O_CONTAINER;\n\n  public oattr: string;\n\n  public title: string;\n  protected _elevation: number = 0;\n  protected defaultLayoutAlign: string = 'start start';\n  protected _layoutAlign: string;\n  public icon: string;\n  protected _appearance: string;\n  protected _layoutGap: string;\n  private _outlineGapCalculationNeededImmediately = false;\n\n  protected titleObserver = new MutationObserver(() => this.updateOutlineGap());\n\n  protected _titleEl: ElementRef;\n  @ViewChild('containerTitle') set containerTitle(elem: ElementRef) {\n    this._titleEl = elem;\n    if (this._titleEl) {\n      this.registerObserver();\n      this.updateOutlineGap(); // This must be triggered when title container is re-registered\n    } else {\n      this.unRegisterObserver();\n    }\n  }\n  @ViewChild('container') protected _containerRef: ElementRef;\n\n  constructor(\n    @Optional() @Inject(forwardRef(() => OFormComponent)) protected form: OFormComponent,\n    protected elRef: ElementRef,\n    protected injector: Injector,\n    @Optional() @Inject(MAT_FORM_FIELD_DEFAULT_OPTIONS) protected matFormDefaultOption\n  ) { }\n\n  ngAfterViewInit(): void {\n    if (this.elRef) {\n      this.elRef.nativeElement.removeAttribute('title');\n    }\n    this.registerObserver();\n  }\n\n  ngAfterContentChecked() {\n    if (this._outlineGapCalculationNeededImmediately) {\n      this.updateOutlineGap();\n    }\n  }\n\n  ngOnDestroy(): void {\n    this.unRegisterObserver();\n  }\n\n  public getAttribute() {\n    if (this.oattr) {\n      return this.oattr;\n    } else if (this.elRef && this.elRef.nativeElement.attributes['attr']) {\n      return this.elRef.nativeElement.attributes['attr'].value;\n    }\n  }\n\n  get appearance() {\n    return this._appearance;\n  }\n\n  set appearance(value: string) {\n    this._appearance = value;\n    setTimeout(() => { this.updateOutlineGap(); });\n  }\n\n  get elevation() {\n    return this._elevation;\n  }\n\n  set elevation(elevation: number) {\n    this._elevation = elevation;\n    this.propagateElevationToDOM();\n  }\n\n  get layoutAlign() {\n    return this._layoutAlign;\n  }\n\n  set layoutAlign(align: string) {\n    if (!align || align.length === 0) {\n      align = this.defaultLayoutAlign;\n    }\n    this._layoutAlign = align;\n  }\n\n  get layoutGap() {\n    return this._layoutGap;\n  }\n\n  set layoutGap(layoutGap: string) {\n    this._layoutGap = layoutGap;\n  }\n\n  public hasHeader(): boolean {\n    return !!this.title || !!this.icon;\n  }\n\n  public isAppearanceOutline(): boolean {\n    let isAppearanceOutline = (this.matFormDefaultOption && this.matFormDefaultOption.appearance === OContainerComponent.APPEARANCE_OUTLINE);\n    if (Util.isDefined(this.appearance)) {\n      isAppearanceOutline = this.appearance === OContainerComponent.APPEARANCE_OUTLINE;\n    }\n    return isAppearanceOutline;\n  }\n\n  public hasTitleInAppearanceOutline(): boolean {\n    return this.isAppearanceOutline() && this.hasHeader();\n  }\n\n  protected propagateElevationToDOM(): void {\n    this.cleanElevationCSSclasses();\n    if (this.elevation > 0 && this.elevation <= 12) {\n      this.elRef.nativeElement.classList.add('mat-elevation-z' + this.elevation);\n    }\n  }\n\n  protected cleanElevationCSSclasses(): void {\n    const classList = [].slice.call(this.elRef.nativeElement.classList);\n    if (classList && classList.length) {\n      classList.forEach((item: string) => {\n        if (item.startsWith('mat-elevation')) {\n          this.elRef.nativeElement.classList.remove(item);\n        }\n      });\n    }\n  }\n\n  protected updateOutlineGap(): void {\n    if (this.isAppearanceOutline()) {\n      const titleEl = this._titleEl ? this._titleEl.nativeElement : null;\n\n      if (!this._containerRef) {\n        return;\n      }\n      if (!document.documentElement!.contains(this.elRef.nativeElement)) {\n        this._outlineGapCalculationNeededImmediately = true;\n        return;\n      }\n\n      const container = this._containerRef.nativeElement;\n      const containerRect = container.getBoundingClientRect();\n      if (containerRect.width === 0 && containerRect.height === 0) {\n        return;\n      }\n\n      const containerStart = containerRect.left;\n      const labelStart = titleEl.getBoundingClientRect().left;\n      const labelWidth = this.hasHeader() ? titleEl.offsetWidth : 0;\n      const startWidth = labelStart - containerStart;\n\n      const startEls = container.querySelectorAll('.o-container-outline-start');\n      const gapEls = container.querySelectorAll('.o-container-outline-gap');\n      gapEls[0].style.width = `${labelWidth}px`;\n      startEls[0].style.width = `${startWidth}px`;\n      this._outlineGapCalculationNeededImmediately = false;\n    }\n  }\n\n  protected registerObserver(): void {\n    if (this._titleEl) {\n      this.titleObserver.observe(this._titleEl.nativeElement, {\n        childList: true,\n        characterData: true,\n        subtree: true\n      });\n    }\n  }\n\n  protected unRegisterObserver(): void {\n    if (this.titleObserver) {\n      this.titleObserver.disconnect();\n    }\n  }\n\n}\n"]}