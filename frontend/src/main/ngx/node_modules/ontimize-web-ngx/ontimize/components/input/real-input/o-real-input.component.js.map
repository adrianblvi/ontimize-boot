{"version":3,"file":"o-real-input.component.js","sourceRoot":"","sources":["../../../../../tmp/ontimize/components/input/real-input/o-real-input.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { CommonModule } from '@angular/common';\nimport { Component, ElementRef, forwardRef, Inject, Injector, NgModule, OnInit, Optional, ViewEncapsulation } from '@angular/core';\nimport { FormControl, ValidationErrors, ValidatorFn } from '@angular/forms';\n\nimport { InputConverter } from '../../../decorators';\nimport { IRealPipeArgument, ORealPipe } from '../../../pipes';\nimport { OSharedModule } from '../../../shared';\nimport { Util } from '../../../util/util';\nimport { OFormComponent } from '../../form/form-components';\nimport { DEFAULT_INPUTS_O_INTEGER_INPUT, DEFAULT_OUTPUTS_O_INTEGER_INPUT, OIntegerInputComponent, OIntegerInputModule } from '../integer-input/o-integer-input.component';\n\nexport const DEFAULT_INPUTS_O_REAL_INPUT = [\n  ...DEFAULT_INPUTS_O_INTEGER_INPUT,\n  'minDecimalDigits: min-decimal-digits',\n  'maxDecimalDigits: max-decimal-digits',\n  'decimalSeparator : decimal-separator'\n];\n\nexport const DEFAULT_OUTPUTS_O_REAL_INPUT = [\n  ...DEFAULT_OUTPUTS_O_INTEGER_INPUT\n];\n\n@Component({\n  moduleId: module.id,\n  selector: 'o-real-input',\n  template: `\n    <div [formGroup]=\"getFormGroup()\" [matTooltip]=\"tooltip\" [matTooltipClass]=\"tooltipClass\"\n      [matTooltipPosition]=\"tooltipPosition\" [matTooltipShowDelay]=\"tooltipShowDelay\"\n      [matTooltipHideDelay]=\"tooltipHideDelay\">\n      <mat-form-field [appearance]=\"appearance\" [floatLabel]=\"floatLabel\" [hideRequiredMarker]=\"hideRequiredMarker\"\n        [class.custom-width]=\"hasCustomWidth\" [class.icon-field]=\"showClearButton\" fxFlexFill>\n        <mat-label *ngIf=\"labelVisible\">{{ olabel | oTranslate }}</mat-label>\n        <input matInput [type]=\"inputType\" [id]=\"getAttribute()\" [formControlName]=\"getAttribute()\"\n          [placeholder]=\"placeHolder\" (focus)=\"innerOnFocus($event)\" (blur)=\"innerOnBlur($event)\"\n          (change)=\"onChangeEvent($event)\" [readonly]=\"isReadOnly\" [min]=\"min\" [max]=\"max\" [step]=\"step\"\n          [required]=\"isRequired\">\n        <button type=\"button\" *ngIf=\"showClearButton\" matSuffix mat-icon-button (click)=\"onClickClearValue($event)\">\n          <mat-icon svgIcon=\"ontimize:close\"></mat-icon>\n        </button>\n        <mat-error *ngIf=\"hasError('required')\" text=\"{{ 'FORM_VALIDATION.REQUIRED' | oTranslate }}\"></mat-error>\n        <mat-error *ngIf=\"hasError('min')\"\n          text=\"{{ 'FORM_VALIDATION.MIN_VALUE' | oTranslate }}: {{ getErrorValue('min', 'requiredMin') }}\"></mat-error>\n        <mat-error *ngIf=\"hasError('max')\"\n          text=\"{{ 'FORM_VALIDATION.MAX_VALUE' | oTranslate }}: {{ getErrorValue('max', 'requiredMax') }}\"></mat-error>\n        <mat-error *ngIf=\"hasError('minDecimaldigits')\"\n          text=\"{{ 'FORM_VALIDATION.MIN_DECIMAL_DIGITS' | oTranslate }}: {{ getErrorValue('minDecimaldigits', 'requiredMinDecimaldigits') }}\">\n        </mat-error>\n        <mat-error *ngIf=\"hasError('maxDecimaldigits')\"\n          text=\"{{ 'FORM_VALIDATION.MAX_DECIMAL_DIGITS' | oTranslate }}: {{ getErrorValue('maxDecimaldigits', 'requiredMaxDecimaldigits') }}\">\n        </mat-error>\n        <mat-error *ngFor=\"let oError of getActiveOErrors()\" text=\"{{ oError.text | oTranslate }}\"></mat-error>\n      </mat-form-field>\n    </div>\n  `,\n  styles: [`\n\n  `],\n  inputs: DEFAULT_INPUTS_O_REAL_INPUT,\n  outputs: DEFAULT_OUTPUTS_O_REAL_INPUT,\n  encapsulation: ViewEncapsulation.None\n})\nexport class ORealInputComponent extends OIntegerInputComponent implements OnInit {\n\n  public static DEFAULT_INPUTS_O_REAL_INPUT = DEFAULT_INPUTS_O_REAL_INPUT;\n  public static DEFAULT_OUTPUTS_O_REAL_INPUT = DEFAULT_OUTPUTS_O_REAL_INPUT;\n\n  @InputConverter()\n  minDecimalDigits: number = 2;\n\n  @InputConverter()\n  maxDecimalDigits: number = 2;\n\n  @InputConverter()\n  step: number = 0.01;\n\n  @InputConverter()\n  grouping: boolean = true;\n\n  protected decimalSeparator: string;\n  protected pipeArguments: IRealPipeArgument;\n\n  constructor(\n    @Optional() @Inject(forwardRef(() => OFormComponent)) form: OFormComponent,\n    elRef: ElementRef,\n    injector: Injector\n  ) {\n    super(form, elRef, injector);\n    this._defaultSQLTypeKey = 'FLOAT';\n  }\n\n  setComponentPipe(): void {\n    this.componentPipe = new ORealPipe(this.injector);\n  }\n\n  ngOnInit(): void {\n    super.ngOnInit();\n    this.pipeArguments.decimalSeparator = this.decimalSeparator;\n    this.pipeArguments.minDecimalDigits = this.minDecimalDigits;\n    this.pipeArguments.maxDecimalDigits = this.maxDecimalDigits;\n  }\n\n  resolveValidators(): ValidatorFn[] {\n    const validators: ValidatorFn[] = super.resolveValidators();\n    if (Util.isDefined(this.minDecimalDigits)) {\n      validators.push(this.minDecimalDigitsValidator.bind(this));\n    }\n    if (Util.isDefined(this.maxDecimalDigits)) {\n      validators.push(this.maxDecimalDigitsValidator.bind(this));\n    }\n    return validators;\n  }\n\n  protected minDecimalDigitsValidator(control: FormControl): ValidationErrors {\n    let ctrlValue: string = control.value;\n    if (typeof control.value === 'number') {\n      ctrlValue = ctrlValue.toString();\n    }\n    if (ctrlValue && ctrlValue.length) {\n      const valArray = ctrlValue.split(this.decimalSeparator ? this.decimalSeparator : '.');\n      if (Util.isDefined(this.minDecimalDigits) && (this.minDecimalDigits > 0) && Util.isDefined(valArray[1]) && (valArray[1].length < this.minDecimalDigits)) {\n        return {\n          minDecimaldigits: {\n            requiredMinDecimaldigits: this.minDecimalDigits\n          }\n        };\n      }\n    }\n    return {};\n  }\n\n  protected maxDecimalDigitsValidator(control: FormControl): ValidationErrors {\n    let ctrlValue: string = control.value;\n    if (typeof control.value === 'number') {\n      ctrlValue = ctrlValue.toString();\n    }\n    if (ctrlValue && ctrlValue.length) {\n      const valArray = ctrlValue.split(this.decimalSeparator ? this.decimalSeparator : '.');\n      if (Util.isDefined(this.maxDecimalDigits) && (this.maxDecimalDigits > 0) && Util.isDefined(valArray[1]) && (valArray[1].length > this.maxDecimalDigits)) {\n        return {\n          maxDecimaldigits: {\n            requiredMaxDecimaldigits: this.maxDecimalDigits\n          }\n        };\n      }\n    }\n    return {};\n  }\n\n  protected initializeStep(): void {\n    if (this.step <= 0) {\n      this.step = 1 / Math.pow(10, this.maxDecimalDigits);\n      console.warn('`step` attribute must be greater than zero');\n    }\n  }\n\n}\n\n@NgModule({\n  declarations: [ORealInputComponent],\n  imports: [CommonModule, OSharedModule, OIntegerInputModule],\n  exports: [OIntegerInputModule, ORealInputComponent]\n})\nexport class ORealInputModule { }\n"]}