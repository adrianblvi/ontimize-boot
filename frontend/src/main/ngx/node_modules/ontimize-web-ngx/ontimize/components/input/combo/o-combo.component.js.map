{"version":3,"file":"o-combo.component.js","sourceRoot":"","sources":["../../../../../tmp/ontimize/components/input/combo/o-combo.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { CommonModule } from '@angular/common';\nimport { AfterViewInit, Component, ElementRef, forwardRef, Inject, Injector, NgModule, OnDestroy, OnInit, Optional, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { FormControl } from '@angular/forms';\nimport { MatSelect, MatSelectChange } from '@angular/material';\nimport { Subscription } from 'rxjs';\nimport { InputConverter } from '../../../decorators/input-converter';\nimport { dataServiceFactory } from '../../../services/data-service.provider';\nimport { OntimizeService } from '../../../services/ontimize.service';\nimport { OSharedModule } from '../../../shared/shared.module';\nimport { Codes } from '../../../util/codes';\nimport { Util } from '../../../util/util';\nimport { OFormComponent } from '../../form/o-form.component';\nimport { IFormValueOptions, OFormValue } from '../../form/OFormValue';\nimport { OValueChangeEvent } from '../../o-form-data-component.class';\nimport { OFormServiceComponent } from '../o-form-service-component.class';\nimport { OComboSearchComponent } from './combo-search/o-combo-search.component';\n\n\nexport const DEFAULT_INPUTS_O_COMBO = [\n  ...OFormServiceComponent.DEFAULT_INPUTS_O_FORM_SERVICE_COMPONENT,\n  'translate',\n  'multiple',\n  'nullSelection: null-selection',\n  'multipleTriggerLabel: multiple-trigger-label',\n  'searchable'\n];\n\nexport const DEFAULT_OUTPUTS_O_COMBO = [\n  ...OFormServiceComponent.DEFAULT_OUTPUTS_O_FORM_SERVICE_COMPONENT\n];\n\n@Component({\n  moduleId: module.id,\n  selector: 'o-combo',\n  providers: [\n    { provide: OntimizeService, useFactory: dataServiceFactory, deps: [Injector] },\n    { provide: OFormServiceComponent, useExisting: forwardRef(() => OComboComponent) }\n  ],\n  inputs: DEFAULT_INPUTS_O_COMBO,\n  outputs: DEFAULT_OUTPUTS_O_COMBO,\n  template: `\n    <div [formGroup]=\"getFormGroup()\" [matTooltip]=\"tooltip\" [matTooltipClass]=\"tooltipClass\" [matTooltipPosition]=\"tooltipPosition\"\n      [matTooltipShowDelay]=\"tooltipShowDelay\" [matTooltipHideDelay]=\"tooltipHideDelay\">\n      <mat-form-field [appearance]=\"appearance\" [floatLabel]=\"floatLabel\" [class.read-only]=\"isReadOnly\" [class.custom-width]=\"hasCustomWidth\"\n        [hideRequiredMarker]=\"hideRequiredMarker\" fxFill>\n        <mat-label *ngIf=\"labelVisible\">{{ olabel | oTranslate }}</mat-label>\n        <mat-select [value]=\"getValue()\" #selectModel [id]=\"getAttribute()\" fxFill [formControlName]=\"getAttribute()\" [placeholder]=\"placeHolder\"\n          [multiple]=\"getMultiple()\" [required]=\"isRequired\" [panelClass]=\"{ 'o-combo-panel': true, 'o-combo-panel-search': searchable }\"\n          (selectionChange)=\"onSelectionChange($event)\">\n          <o-combo-search *ngIf=\"searchable\" [formControl]=\"searchControl\"></o-combo-search>\n\n          <mat-select-trigger *ngIf=\"multiple && multipleTriggerLabel\">\n            {{ selectModel.selected[0] ? getFirstSelectedValue(): '' }}\n            <span *ngIf=\"getFormControl().value.length > 1\">\n              {{ 'INPUT.COMBO.MESSAGE_TRIGGER' | oTranslate: { values: [getFormControl().value.length -1] } }}\n            </span>\n          </mat-select-trigger>\n\n          <div class=\"o-combo-options-container\">\n            <mat-option *ngIf=\"hasNullSelection()\" [value]=\"null\"></mat-option>\n            <mat-option *ngFor=\"let item of getFilteredDataArray()\" [value]=\"getValueColumn(item)\">\n              {{ getOptionDescriptionValue(item) }}\n            </mat-option>\n          </div>\n        </mat-select>\n\n        <mat-error *ngIf=\"hasError('required')\" text=\"{{ 'FORM_VALIDATION.REQUIRED' | oTranslate }}\"></mat-error>\n        <mat-error *ngFor=\"let oError of getActiveOErrors()\" text=\"{{ oError.text | oTranslate }}\"></mat-error>\n      </mat-form-field>\n    </div>\n  `,\n  styles: [`\n    .o-combo .read-only .mat-select-arrow-wrapper{visibility:hidden}.o-combo .read-only .mat-form-field-underline{background-image:none}.o-combo .mat-select{line-height:normal}.o-combo-panel.o-combo-panel-search{overflow:hidden}.o-combo-panel.o-combo-panel-search .mat-select-content{height:100%}.o-combo-panel.o-combo-panel-search .mat-select-content .o-combo-options-container{height:calc(100% - 3em);overflow:auto}\n  `],\n  encapsulation: ViewEncapsulation.None,\n  host: {\n    '[class.o-combo]': 'true'\n  }\n})\nexport class OComboComponent extends OFormServiceComponent implements OnInit, AfterViewInit, OnDestroy {\n\n  public static DEFAULT_INPUTS_O_COMBO = DEFAULT_INPUTS_O_COMBO;\n  public static DEFAULT_OUTPUTS_O_COMBO = DEFAULT_OUTPUTS_O_COMBO;\n\n  public value: OFormValue;\n  public searchControl: FormControl = new FormControl();\n\n  /* Inputs */\n  @InputConverter()\n  public multiple: boolean;\n  @InputConverter()\n  public multipleTriggerLabel: boolean = false;\n  @InputConverter()\n  public searchable: boolean = false;\n  @InputConverter()\n  protected translate: boolean = false;\n  @InputConverter()\n  protected nullSelection: boolean = true;\n  /* End inputs*/\n\n  @ViewChild('inputModel')\n  protected inputModel: ElementRef;\n\n  @ViewChild('selectModel')\n  protected selectModel: MatSelect;\n\n  protected filteredDataArray: any[] = [];\n  protected subscription: Subscription = new Subscription();\n\n  constructor(\n    @Optional() @Inject(forwardRef(() => OFormComponent)) form: OFormComponent,\n    elRef: ElementRef,\n    injector: Injector\n  ) {\n    super(form, elRef, injector);\n    this.defaultValue = '';\n  }\n\n  public ngOnInit(): void {\n    super.ngOnInit();\n    this.subscription.add(this.searchControl.valueChanges.subscribe(() => this.searchFilter()));\n  }\n\n  public ngAfterViewInit(): void {\n    super.ngAfterViewInit();\n    if (this.queryOnInit) {\n      this.queryData();\n    } else if (this.queryOnBind) {\n      // TODO do it better. When changing tabs it is necessary to invoke new query\n      this.syncDataIndex();\n    }\n  }\n\n  public ngOnDestroy(): void {\n    this.subscription.unsubscribe();\n    this.destroy();\n  }\n\n  public initialize(): void {\n    super.initialize();\n    if (this.multiple) {\n      this.nullSelection = false;\n      this.defaultValue = [];\n    }\n  }\n\n  public ensureOFormValue(value: any): void {\n    if (value instanceof OFormValue) {\n      this.value = new OFormValue(value.value);\n    } else if (Util.isDefined(value) && !(value instanceof OFormValue)) {\n      this.value = new OFormValue(value);\n    } else if (!Util.isDefined(value) && this.nullSelection) {\n      this.value = new OFormValue(undefined);\n    } else {\n      this.value = new OFormValue(this.defaultValue);\n    }\n    // This call make the component querying its data multiple times\n    // this.syncDataIndex();\n  }\n\n  public setDataArray(data: any): void {\n    super.setDataArray(data);\n    this.filteredDataArray = data;\n  }\n\n  public getDataArray(): any[] {\n    return this.dataArray;\n  }\n\n  public getFilteredDataArray(): any[] {\n    return this.filteredDataArray;\n  }\n\n  public hasNullSelection(): boolean {\n    return this.nullSelection;\n  }\n\n  public syncDataIndex(queryIfNotFound: boolean = true): void {\n    super.syncDataIndex(queryIfNotFound);\n    if (this._currentIndex !== undefined && this.nullSelection) {\n      // first position is for null selection that it is not included into dataArray\n      this._currentIndex += 1;\n    }\n  }\n\n  public getValue(): any {\n    if (this.value instanceof OFormValue) {\n      if (this.value.value !== undefined) {\n        return this.value.value;\n      } else if (this.value.value === undefined) {\n        return this.getEmptyValue();\n      }\n    }\n    return '';\n  }\n\n  public getEmptyValue(): any {\n    if (this.multiple) {\n      return [];\n    } else {\n      if (this.nullSelection) {\n        return undefined;\n      } else {\n        return '';\n      }\n    }\n  }\n\n  public clearValue(): void {\n    if (this.multiple) {\n      this.setValue(this.defaultValue);\n    } else {\n      super.clearValue();\n    }\n  }\n\n  public getMultiple(): boolean {\n    return this.multiple;\n  }\n\n  public onSelectionChange(event: MatSelectChange): void {\n    if (!this.selectModel.panelOpen) {\n      return;\n    }\n    const newValue = event.value;\n    this.setValue(newValue, {\n      changeType: OValueChangeEvent.USER_CHANGE,\n      emitEvent: false,\n      emitModelToViewChange: false\n    });\n  }\n\n  public getOptionDescriptionValue(item: any = {}): string {\n    let descTxt = '';\n    if (this.descriptionColArray && this.descriptionColArray.length > 0) {\n      const self = this;\n      this.descriptionColArray.forEach((col, index) => {\n        let txt = item[col];\n        if (Util.isDefined(txt)) {\n          if (self.translate && self.translateService) {\n            txt = self.translateService.get(txt);\n          }\n          descTxt += txt;\n        }\n        if (index < self.descriptionColArray.length - 1) {\n          descTxt += self.separator;\n        }\n      });\n    }\n    return descTxt;\n  }\n\n  public getValueColumn(item: any): any {\n    if (item && item.hasOwnProperty(this.valueColumn)) {\n      let option = item[this.valueColumn];\n      if (option === 'undefined') {\n        option = null;\n      }\n      return option;\n    }\n    return '';\n  }\n\n  public isSelected(item: any, rowIndex: number): boolean {\n    let selected = false;\n    if (item && item.hasOwnProperty(this.valueColumn) && this.value) {\n      const val = item[this.valueColumn];\n      if (val === this.value.value) {\n        selected = true;\n        this._currentIndex = rowIndex;\n      }\n    }\n    return selected;\n  }\n\n  public setValue(val: any, options?: IFormValueOptions): void {\n    if (!this.dataArray) {\n      return;\n    }\n    const isDefinedVal = Util.isDefined(val);\n    if (this.multiple && !isDefinedVal) {\n      return;\n    }\n\n    if (!isDefinedVal && !this.nullSelection) {\n      console.warn('`o-combo` with attr ' + this.oattr + ' cannot be set. `null-selection` attribute is false.');\n      return;\n    }\n\n    if (isDefinedVal) {\n      const record = this.dataArray.find(item => item[this.valueColumn] === val);\n      if (!Util.isDefined(record)) {\n        return;\n      }\n    } else {\n      if (Util.isDefined(val)) {\n        super.setValue(val, options);\n      }\n    }\n    super.setValue(val, options);\n  }\n\n  public getSelectedItems(): any[] {\n    return this.getValue();\n  }\n\n  public setSelectedItems(values: any[]): void {\n    this.setValue(values);\n  }\n\n  public getFirstSelectedValue(): void {\n    return this.selectModel.selected[0].viewValue;\n  }\n\n  protected setIsReadOnly(value: boolean): void {\n    super.setIsReadOnly(value);\n    const readOnly = Util.isDefined(this.readOnly) ? this.readOnly : value;\n    if (this.enabled) {\n      if (this._fControl && readOnly) {\n        this._fControl.disable();\n      } else if (this._fControl) {\n        this._fControl.enable();\n      }\n    }\n  }\n  protected parseByValueColumnType(val: any): any {\n    if (!Util.isDefined(this.multiple)) {\n      return val;\n    }\n    const valueArr: any[] = this.multiple ? val : [val];\n    if (this.valueColumnType === Codes.TYPE_INT) {\n      valueArr.forEach((item, index) => {\n        const parsed = parseInt(item);\n        if (!isNaN(parsed)) {\n          valueArr[index] = parsed;\n        }\n      });\n    }\n    return this.multiple ? valueArr : valueArr[0];\n  }\n\n  protected searchFilter(): void {\n    if (this.dataArray || this.dataArray.length) {\n\n      // get the search keyword\n      let search = this.searchControl.value;\n      if (!search) {\n        this.filteredDataArray = this.dataArray.slice();\n        return;\n      } else {\n        search = search.toLowerCase();\n      }\n\n      // filter\n      this.filteredDataArray = this.dataArray.filter(item => this.getOptionDescriptionValue(item).toLowerCase().indexOf(search) > -1);\n    }\n  }\n\n}\n\n@NgModule({\n  declarations: [OComboComponent, OComboSearchComponent],\n  imports: [CommonModule, OSharedModule],\n  exports: [OComboComponent, OComboSearchComponent]\n})\nexport class OComboModule { }\n"]}