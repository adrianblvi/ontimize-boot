{"version":3,"file":"o-base-menu-item.class.js","sourceRoot":"","sources":["../../../../tmp/ontimize/components/bar-menu/o-base-menu-item.class.ts"],"names":[],"mappings":"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","sourcesContent":["import { OnInit, Injector, ElementRef, HostListener, OnDestroy } from '@angular/core';\nimport { Subscription } from 'rxjs';\nimport { PermissionsUtils } from '../../util/permissions';\nimport { OTranslateService, OPermissions } from '../../services';\nimport { Util } from '../../utils';\nimport { OBarMenuComponent } from './o-bar-menu.component';\n\nexport const DEFAULT_INPUTS_O_BASE_MENU_ITEM = [\n  // title [string]: menu item title. Default: no value.\n  'title',\n\n  // tooltip [string]: menu group tooltip. Default: 'title' value.\n  'tooltip',\n\n  // icon [string]: material icon. Default: no value.\n  'icon',\n\n  'attr'\n];\n\nexport class OBaseMenuItemClass implements OnInit, OnDestroy {\n\n  public static DEFAULT_INPUTS_O_BASE_MENU_ITEM = DEFAULT_INPUTS_O_BASE_MENU_ITEM;\n\n  protected translateService: OTranslateService;\n  protected onLanguageChangeSubscription: Subscription;\n\n  title: string;\n  tooltip: string;\n  icon: string;\n  restricted: boolean;\n  disabled: boolean;\n  protected _isHovered: boolean = false;\n  attr: string;\n\n  @HostListener('mouseover') onMouseover = () => this.isHovered = true;\n  @HostListener('mouseout') onMouseout = () => this.isHovered = false;\n\n  protected permissions: OPermissions;\n  protected mutationObserver: MutationObserver;\n\n  constructor(\n    protected menu: OBarMenuComponent,\n    protected elRef: ElementRef,\n    protected injector: Injector) {\n\n    this.translateService = this.injector.get(OTranslateService);\n  }\n\n  ngOnInit() {\n    if (!this.tooltip) {\n      this.tooltip = this.title;\n    }\n    if (this.translateService) {\n      this.onLanguageChangeSubscription = this.translateService.onLanguageChanged.subscribe(() => {\n        this.setDOMTitle();\n      });\n      this.setDOMTitle();\n    }\n    this.parsePermissions();\n  }\n\n  ngOnDestroy(): void {\n    if (this.onLanguageChangeSubscription) {\n      this.onLanguageChangeSubscription.unsubscribe();\n    }\n    if (this.mutationObserver) {\n      this.mutationObserver.disconnect();\n    }\n  }\n\n  setDOMTitle() {\n    let tooltip = this.translateService.get(this.tooltip);\n    this.elRef.nativeElement.setAttribute('title', tooltip);\n  }\n\n  protected parsePermissions() {\n    // if oattr in form, it can have permissions\n    this.permissions = this.menu.getPermissionsService().getMenuPermissions(this.attr);\n    if (!Util.isDefined(this.permissions)) {\n      return;\n    }\n    this.restricted = this.permissions.visible === false;\n    this.disabled = this.permissions.enabled === false;\n\n    if (this.disabled) {\n      this.mutationObserver = PermissionsUtils.registerDisabledChangesInDom(this.elRef.nativeElement, {\n        checkStringValue: true\n      });\n    }\n  }\n\n  get isHovered(): boolean {\n    return this._isHovered;\n  }\n\n  set isHovered(val: boolean) {\n    if (!this.disabled) {\n      this._isHovered = val;\n    }\n  }\n}\n"]}