{"version":3,"file":"o-image.component.js","sourceRoot":"","sources":["../../../../tmp/ontimize/components/image/o-image.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { CommonModule } from '@angular/common';\nimport { Component, ElementRef, forwardRef, HostBinding, Inject, Injector, NgModule, Optional, ViewChild, ViewEncapsulation } from '@angular/core';\nimport { FormControl, FormGroup } from '@angular/forms';\nimport { MatDialog } from '@angular/material';\nimport { DomSanitizer } from '@angular/platform-browser';\nimport { InputConverter } from '../../decorators';\nimport { OSharedModule } from '../../shared';\nimport { Util } from '../../util/util';\nimport { OFormComponent } from '../form/o-form.component';\nimport { OFormValue } from '../form/OFormValue';\nimport { OFormControl } from '../input/o-form-control.class';\nimport { DEFAULT_INPUTS_O_FORM_DATA_COMPONENT, DEFAULT_OUTPUTS_O_FORM_DATA_COMPONENT, OFormDataComponent } from '../o-form-data-component.class';\nimport { OFullScreenDialogComponent } from './fullscreen/fullscreen-dialog.component';\n\n\nexport const DEFAULT_INPUTS_O_IMAGE = [\n  ...DEFAULT_INPUTS_O_FORM_DATA_COMPONENT,\n  'emptyimage: empty-image',\n  // empty-icon [string]: material icon. Default: photo.\n  'emptyicon: empty-icon',\n  // show-controls [yes|no true|false]: Shows or hides selection controls. Default: true.\n  'showControls: show-controls',\n  // height [% | px]: Set the height of the image.\n  'height',\n  // auto-fit [yes|no true|false]: Adjusts the image to the content or not. Default: true.\n  'autoFit: auto-fit',\n  'fullScreenButton: full-screen-button',\n  // accept-file-type [string]: file types allowed on the file input, separated by ';'. Default: image/*.\n  // file_extension, image/*, media_type. See https://www.w3schools.com/tags/att_input_accept.asp\n  'acceptFileType: accept-file-type'\n];\n\nexport const DEFAULT_OUTPUTS_O_IMAGE = [\n  ...DEFAULT_OUTPUTS_O_FORM_DATA_COMPONENT\n];\n\n@Component({\n  moduleId: module.id,\n  selector: 'o-image',\n  template: `\n    <div fxLayout=\"column\" [formGroup]=\"getFormGroup()\" [matTooltip]=\"tooltip\" [matTooltipPosition]=\"tooltipPosition\"\n      [matTooltipShowDelay]=\"tooltipShowDelay\" [matTooltipHideDelay]=\"tooltipHideDelay\" [class.o-image-auto-fit]=\"autoFit\"\n      class=\"o-image-content\" fxFill>\n\n      <mat-form-field *ngIf=\"hasControls()\" class=\"o-image-form-field\">\n        <input matInput readonly (click)=\"input.click()\" [placeholder]=\"olabel | oTranslate\" [required]=\"isRequired\" [formControl]=\"stateCtrl\" />\n        <input matInput [formControlName]=\"getAttribute()\" type=\"text\" [id]=\"getAttribute()\" class=\"o-image-form-field-input\" [required]=\"isRequired\" />\n        <input #input type=\"file\" [disabled]=\"!enabled\" [accept]=\"acceptFileType ? acceptFileType.replace(';',',') : 'image/*'\" (change)=\"fileChange(input)\"\n          class=\"o-image-form-field-hidden\" fxFlex />\n\n        <button type=\"button\" *ngIf=\"fullScreenButton\" [disabled]=\"!enabled\" matSuffix mat-icon-button\n          (click)=\"openFullScreen($event)\">\n          <mat-icon svgIcon=\"ontimize:fullscreen\"></mat-icon>\n        </button>\n        <button type=\"button\" [disabled]=\"!enabled\" matSuffix mat-icon-button (click)=\"input.click()\">\n          <mat-icon svgIcon=\"ontimize:folder_open\"></mat-icon>\n        </button>\n        <button type=\"button\" [disabled]=\"!enabled\" matSuffix mat-icon-button (click)=\"onClickClearValue($event)\">\n          <mat-icon svgIcon=\"ontimize:close\"></mat-icon>\n        </button>\n        <mat-error *ngIf=\"hasError('required')\">{{ 'FORM_VALIDATION.REQUIRED' | oTranslate }}</mat-error>\n      </mat-form-field>\n\n      <div fxLayout=\"column\" fxLayoutAlign=\"center center\" fxFlex=\"grow\" class=\"o-image-display-container\">\n        <img *ngIf=\"!(isEmpty())\" [src]=\"getSrcValue()\" alt=\"\" (click)=\"openFileSelector()\" />\n        <mat-icon class=\"empty-icon\" [class.mat-disabled]=\"!enabled\" aria-label=\"empty image\" *ngIf=\"useEmptyIcon()\" (click)=\"openFileSelector()\">\n          {{ emptyicon }}</mat-icon>\n        <img [src]=\"getSrcValue()\" alt=\"empty image\" *ngIf=\"useEmptyImage()\" (click)=\"openFileSelector()\" />\n      </div>\n      <div *ngIf=\"isReadOnly\" fxFill class=\"read-only-blocker\" (click)=\"onClickBlocker($event)\"></div>\n    </div>\n  `,\n  styles: [`\n    .o-image{display:flex;height:inherit}.o-image .o-image-content{position:relative;width:100%}.o-image .o-image-content .o-image-form-field{width:100%}.o-image .o-image-content .o-image-form-field .o-image-form-field-hidden{display:none !important}.o-image .o-image-content .o-image-form-field .o-image-form-field-input{opacity:0;outline:none;width:0}.o-image .o-image-content .o-image-display-container{width:100%}.o-image .o-image-content .o-image-display-container>img{height:100%;width:100%}.o-image .o-image-content.o-image-auto-fit .o-image-display-container>img{height:auto;max-height:100%;max-width:100%;object-fit:contain;width:auto}.o-image .o-image-content .read-only-blocker{left:0;right:0;position:absolute;top:0;z-index:2}\n  `],\n  inputs: DEFAULT_INPUTS_O_IMAGE,\n  outputs: DEFAULT_OUTPUTS_O_IMAGE,\n  encapsulation: ViewEncapsulation.None,\n  host: {\n    '[class.o-image]': 'true'\n  }\n})\nexport class OImageComponent extends OFormDataComponent {\n\n  public static DEFAULT_INPUTS_O_IMAGE = DEFAULT_INPUTS_O_IMAGE;\n  public static DEFAULT_OUTPUTS_O_IMAGE = DEFAULT_OUTPUTS_O_IMAGE;\n\n  public acceptFileType: string = 'image/*';\n  public emptyimage: string;\n  public emptyicon: string;\n  public height: string;\n  @InputConverter()\n  public autoFit: boolean = true;\n  public currentFileName: string = '';\n  @InputConverter()\n  protected showControls: boolean = true;\n  set fullScreenButton(val: boolean) {\n    val = Util.parseBoolean(String(val));\n    this._fullScreenButton = val;\n  }\n  get fullScreenButton(): boolean {\n    return this._fullScreenButton;\n  }\n  protected _fullScreenButton = false;\n\n  @ViewChild('input')\n  protected fileInput: ElementRef;\n  protected _useEmptyIcon: boolean = true;\n  protected _useEmptyImage: boolean = false;\n  protected _domSanitizer: DomSanitizer;\n  protected dialog: MatDialog;\n  public stateCtrl: FormControl;\n\n  constructor(\n    @Optional() @Inject(forwardRef(() => OFormComponent)) form: OFormComponent,\n    elRef: ElementRef,\n    injector: Injector\n  ) {\n    super(form, elRef, injector);\n    this._domSanitizer = this.injector.get(DomSanitizer);\n    this._defaultSQLTypeKey = 'BASE64';\n    this.dialog = this.injector.get(MatDialog);\n    this.stateCtrl = new FormControl();\n  }\n\n  public ngOnInit(): void {\n    super.ngOnInit();\n\n    if (this.emptyimage && this.emptyimage.length > 0) {\n      this._useEmptyIcon = false;\n      this._useEmptyImage = true;\n    }\n\n    if (this.emptyicon === undefined && !this._useEmptyImage) {\n      this.emptyicon = 'photo';\n      this._useEmptyIcon = true;\n      this._useEmptyImage = false;\n    }\n  }\n\n  public ngOnDestroy(): void {\n    super.ngOnDestroy();\n  }\n\n  public ensureOFormValue(val: any): void {\n    if (val instanceof OFormValue) {\n      if (val.value && val.value.bytes !== undefined) {\n        this.value = new OFormValue(val.value.bytes);\n        return;\n      }\n      this.value = new OFormValue(val.value);\n    } else if (val && !(val instanceof OFormValue)) {\n      if (val.bytes !== undefined) {\n        val = val.bytes;\n      } else if (val.length > 300 && val.substring(0, 4) === 'data') {\n        // Removing \"data:image/*;base64,\"\n        val = val.substring(val.indexOf('base64') + 7);\n      }\n      this.value = new OFormValue(val);\n    } else {\n      this.value = new OFormValue(undefined);\n    }\n  }\n\n  public isEmpty(): boolean {\n    return !this.getValue() || this.getValue().length === 0;\n  }\n\n  public createFormControl(): OFormControl {\n    this._fControl = super.createFormControl();\n    this._fControl.fControlChildren = [this.stateCtrl];\n    return this._fControl;\n  }\n\n  public fileChange(input): void {\n    if (input.files[0]) {\n      const reader = new FileReader();\n      const self = this;\n      reader.addEventListener('load', event => {\n        let result = event.target['result'];\n        if (result && result.length > 300 && result.substring(0, 4) === 'data') {\n          // Removing \"data:image/*;base64,\"\n          result = result.substring(result.indexOf('base64') + 7);\n        }\n        self.setValue(result);\n        if (self._fControl) {\n          self._fControl.markAsTouched();\n        }\n        event.stopPropagation();\n      }, false);\n      if (input.files[0]) {\n        reader.readAsDataURL(input.files[0]);\n      }\n      // if (this.titleLabel) {\n      //   this.titleLabel.nativeElement.textContent = input.files[0].name;\n      // }\n      this.currentFileName = input.files[0].name;\n      this.stateCtrl.setValue(this.currentFileName);\n    }\n  }\n\n  public getSrcValue(): any {\n    if (this.value && this.value.value) {\n      if (this.value.value instanceof Object && this.value.value.bytes) {\n        let src: string = '';\n        if (this.value.value.bytes.substring(0, 4) === 'data') {\n          src = 'data:image/*;base64,' + this.value.value.bytes.substring(this.value.value.bytes.indexOf('base64') + 7);\n        } else {\n          src = 'data:image/*;base64,' + this.value.value.bytes;\n        }\n        return this._domSanitizer.bypassSecurityTrustUrl(src);\n      } else if (typeof this.value.value === 'string' &&\n        this.value.value.length > 300) {\n        let src: string = '';\n        if (this.value.value.substring(0, 4) === 'data') {\n          src = 'data:image/*;base64,' + this.value.value.substring(this.value.value.indexOf('base64') + 7);\n        } else {\n          src = 'data:image/*;base64,' + this.value.value;\n        }\n        return this._domSanitizer.bypassSecurityTrustUrl(src);\n      }\n      return this.value.value ? this.value.value : this.emptyimage;\n    } else if (this.emptyimage) {\n      return this.emptyimage;\n    }\n  }\n\n  public onClickBlocker(evt: Event): void {\n    evt.stopPropagation();\n  }\n\n  public onClickClearValue(e: Event): void {\n    if (!this.isReadOnly && this.enabled) {\n      super.onClickClearValue(e);\n      this.fileInput.nativeElement.value = '';\n      // if (this.titleLabel) {\n      //   this.titleLabel.nativeElement.textContent = '';\n      // }\n      this.stateCtrl.reset();\n      this.currentFileName = '';\n    }\n    if (this._fControl) {\n      this._fControl.markAsTouched();\n    }\n  }\n\n  public hasControls(): boolean {\n    return this.showControls;\n  }\n\n  public useEmptyIcon(): boolean {\n    return this._useEmptyIcon && this.isEmpty();\n  }\n\n  public useEmptyImage(): boolean {\n    return this._useEmptyImage && this.isEmpty();\n  }\n\n  public getFormGroup(): FormGroup {\n    let formGroup: FormGroup = super.getFormGroup();\n    if (!formGroup) {\n      formGroup = new FormGroup({});\n      formGroup.addControl(this.getAttribute(), this.getControl());\n    }\n    return formGroup;\n  }\n\n  @HostBinding('style.height')\n  get hostHeight(): string {\n    return this.height;\n  }\n\n  public openFullScreen(e?: Event): void {\n    this.dialog.open(OFullScreenDialogComponent, {\n      width: '90%',\n      height: '90%',\n      role: 'dialog',\n      disableClose: false,\n      panelClass: 'o-image-fullscreen-dialog-cdk-overlay',\n      data: this.getSrcValue()\n    });\n  }\n\n  public openFileSelector(e?: Event): void {\n    if (Util.isDefined(this.fileInput)) {\n      this.fileInput.nativeElement.click();\n    }\n  }\n\n  public internalFormControl(): string {\n    return this.getAttribute() + '_value';\n  }\n\n}\n\n@NgModule({\n  declarations: [OImageComponent, OFullScreenDialogComponent],\n  imports: [CommonModule, OSharedModule],\n  exports: [OImageComponent, OFullScreenDialogComponent],\n  entryComponents: [OFullScreenDialogComponent]\n})\nexport class OImageModule { }\n"]}